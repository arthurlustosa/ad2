---
title: "Lab2 - Parte 2"
output: 
  html_document:
    toc : true
    toc_float: true
    
---

```{r setup, include=FALSE}
library(dplyr)
library(reshape2)
library(GGally)
library(ggplot2)
```

## Lendo os dados

```{r}
dados <- read.csv("dados/graduados.csv")
```


## Conhecendo os dados
```{r}
graduados <- dados %>%
  arrange(matricula)

graduados.clean <- graduados %>%
  filter(!is.na(media))

graduados.cra <- graduados.clean %>%
  group_by(matricula) %>%
  mutate(cra.contrb = media*creditos) %>%
  summarise(cra = sum(cra.contrb)/sum(creditos))

graduados.model.input <- graduados.clean %>%
  group_by(matricula, disciplina) %>%
  filter(media == max(media))%>%
  ungroup() %>%
  select(matricula, disciplina, media) %>%
  mutate(disciplina = as.factor(gsub(" ", ".", disciplina))) %>%
  dcast(matricula ~disciplina, mean) %>%
  merge(graduados.cra)

```

```{r}
primeiro.periodo <- graduados.model.input %>%
  select(matricula, Cálculo.Diferencial.e.Integral.I, Álgebra.Vetorial.e.Geometria.Analítica, Leitura.e.Produção.de.Textos, Programação.I, Introdução.à.Computação, Laboratório.de.Programação.I, cra)

segundo.periodo <-  graduados.model.input %>%
  select(matricula, Cálculo.Diferencial.e.Integral.II, Matemática.Discreta, Programação.II, Teoria.dos.Grafos, Fundamentos.de.Física.Clássica, Laboratório.de.Programação.II, cra)

primeiro.periodo <- na.omit(primeiro.periodo)
segundo.periodo <- na.omit(segundo.periodo)


  
ggpairs(primeiro.periodo %>% select(-matricula))

```